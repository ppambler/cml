### ✍️ Tangxt ⏳ 2021-12-23 🏷️ uni-app

# 第 7 章 全局状态管理

1）开篇

在上一章中我们完成了 “一半” 的文章搜索功能，并且留下了一些问题。那么这些历史残留的问题，我们将会在本章节中通过 **全局状态管理工具** 进行处理。

那么究竟什么是 **全局状态管理工具**呢？我们又如何在 `uniapp` 中使用 全局状态管理工具来解决我们的问题呢？，在完成我们剩下的 文章搜索功能 的时候，我们是否还会再遇到其他的坑呢？

这些内容我们都会在本章节中为大家一一讲解。

2）状态管理 - 全局状态管理工具

> 老套路，接触一个新知识，还是得先从「为什么要学习它」，然后「针对它提出你的疑问」，最后「带着你的疑问在学习它的时候去解决这些疑问」 -> 终极目的：应用到你的项目中！

1、场景

在上一章中，我们遇到了一个问题：**`search-blog` 和 `search-history`、`searchData` 和 组件** 之间 **强耦合** 。

如果想要解决这个问题，那么我们需要使用到一个叫做：**全局状态管理工具** 的东西。

学习过 `vue` 的同学应该知道，在 `vue` 中，存在一个 [vuex](https://vuex.vuejs.org/zh/)  的库，这个库的作用就是：**全局状态管理**。

而在 `uniapp` 里，如果我们想要实现 **全局状态管理**，那么 [vuex](https://vuex.vuejs.org/zh/) 也将是一个非常好的选择。

那么下面我们就来看一下，什么是 **全局状态管理工具**，以及什么是 [vuex](https://vuex.vuejs.org/zh/) 

2、问题

> 1. 什么是全局状态管理模式 和 什么是全局状态管理工具
> 2. 什么是 vuex

3、知识

明确这两个问题，就开始学习新知识了

**“单向数据流” 理念示意图**

![全局状态管理](assets/img/2021-12-23-14-26-23.png)

这种图表示的是单向数据流这个模型概念

啥意思？当我们的应用运用在用户手中的时候 -> 用户所有的操作，这最终操作的东西是什么呢？ -> 用户直接操作的是视图吗？ -> 其实并不是，对于当前的所有用户而言，用户直接操作的内容其实是我们的数据，当我们的数据发生变化的时候，我们的视图是跟随发生变化的，而视图的跟随发生变化会直接反馈到用户他的这一个操作之中 -> 这样一个模型我们就把它称之为是一个单向的数据流模型

简单来说就是：用户操作 -> 修改数据，数据变化 -> 视图跟随数据发生变化，视图发生变化 -> 反应到用户的眼中来完成用户最初的这个操作

- **state**，驱动应用的数据源；
- **view**，以声明方式将 **state** 映射到视图；
- **actions**，响应在 **view** 上的用户输入导致的状态变化。

---

这是我最初的认识误区：

![认识](assets/img/2021-12-23-14-43-30.png)

---

但是，这样一个单向数据流处理其实在某些情况下会非常危险

比如说：

当我们的应用遇到**多个组件共享状态（数据）**时，单向数据流的简洁性很容易被破坏（回忆 `search-blog` 和 `search-history` 的代码，`searchData`这个数据在这两个组件里边都有被访问到） -> 破坏的原因是：

- 多个视图依赖于同一状态（数据）
- 来自不同视图的行为需要变更同一状态（数据）

![数据](assets/img/2021-12-23-14-51-26.png)

我们在这两个组件里边分别对这个数据做不同的操作 -> 这种不同行为，影响了一个数据的变化

为了解决这个问题

所以我们不得不通过 **父子组件传递数据** 的方式，来频繁的修改状态（数据）：

![父子通信](assets/img/2021-12-23-14-54-43.png)

但是这种方式是 **非常脆弱，通常会导致无法维护的代码。**

说白了就是组件之间的耦合性太强了

那如何解决呢？ -> 必须使用全局状态管理模式

💡：什么是全局状态管理模式？

![全局状态管理工具](assets/img/2021-12-23-15-00-38.png)

 > 全局状态管理模式：**把多个组件之中共用的数据给抽离出来，也就是抽离到一个单独的地方，然后通过一个 单例模式 去进行管理**，而这种管理的方式就叫做【全局状态管理模式】。（关于全局状态的一个管理模式）

而具备 【全局状态管理模式】 的库，我们就把它称之为：【全局状态管理工具】

而在 `vue` 中存在一个专门的 【全局状态管理工具】，叫做 `vuex`。

因为 `uniapp` 其实追随了 `vue` 和 `微信小程序` 的语法，所以我们可以在 `uniapp` 中使用 `vuex` 来进行 【全局状态管理】，并且这是一个 **非常被推荐** 的选择。

明确了这些概念之后，就来看一下之前我们描述的问题

4、答案

问题 1：

![问题 1](assets/img/2021-12-23-15-03-08.png)

问题 2：

![问题 2](assets/img/2021-12-23-15-04-54.png)

学到了啥？

- 全局状态管理工具的概念是啥？
- 接触到的新工具：Vuex

👇：使用 Vuex 管理我们整个项目中的所有共享数据！

3）状态管理 - 在项目中导入 vuex
