### âœï¸ Tangxt â³ 2021-12-27 ğŸ·ï¸ uni-app

# ç¬¬ 9 ç«  ç”¨æˆ·ç™»å½•

1ï¼‰å¼€ç¯‡

åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬è¯´åˆ°ï¼šå¦‚æœæƒ³è¦å®Œæˆï¼šå…³æ³¨ã€æ”¶è—ã€ç‚¹èµã€è¯„è®º è¿™äº›åŠŸèƒ½çš„è¯ï¼Œé‚£ä¹ˆéœ€è¦é¦–å…ˆå®Œæˆ **ç”¨æˆ·ç™»å½•** çš„åŠŸèƒ½ã€‚

é‚£ä¹ˆè¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•å®Œæˆ **ç”¨æˆ·ç™»å½•** çš„åŠŸèƒ½å®ç°ã€‚

é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ **ç”¨æˆ·ç™»å½•** çš„ä¸šåŠ¡é€»è¾‘ã€‚

å¯¹äº **ç”¨æˆ·ç™»å½•** æ¥è¯´ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªç™»å½•çš„å…¥å£ï¼š

1. åœ¨ã€Šæˆ‘çš„é¡µé¢ã€‹ä¸­ -> ä¹Ÿå«ä¸ªäººä¸­å¿ƒ
2. åœ¨è°ƒç”¨éœ€è¦ç™»å½•æƒé™çš„åŠŸèƒ½æ—¶

![ç™»å½•å…¥å£](assets/img/2021-12-27-19-35-40.png)

é‚£ä¹ˆåœ¨æ˜ç¡®äº† **ç”¨æˆ·ç™»å½•** çš„ä¸šåŠ¡é€»è¾‘ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å»å®ç°ç”¨æˆ·ç™»å½•çš„å¯¹åº”åŠŸèƒ½ã€‚

2ï¼‰ç”¨æˆ·ç™»å½• - ç™»å½•é¡µé¢åŸºæœ¬æ ·å¼

æ•ˆæœï¼š

![æ•ˆæœ](assets/img/2021-12-27-20-38-44.png)

> [Demo](https://github.com/ppambler/imooc-uni-app/commit/fa93150)

3ï¼‰ç”¨æˆ·ç™»å½• - å°è£…ç™»å½•ç»„ä»¶

åœ¨å¼€ç¯‡ä¸­ï¼Œæˆ‘ä»¬è¯´åˆ°ï¼Œå¯¹äº **ç™»å½•** åŠŸèƒ½æ¥è¯´æä¾›äº†ä¸¤ä¸ªç™»å½•çš„å…¥å£ã€‚

é‚£ä¹ˆå¤§å®¶æƒ³ä¸€ä¸‹ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»åœ¨ **æˆ‘çš„** è¿™ä¸ª `tab é¡µ` ä¸­å®ç°äº† **ç™»å½•çš„ `UI`**ï¼Œéš¾é“æˆ‘è¿˜éœ€è¦åœ¨å¦å¤–ä¸€ä¸ªé¡µé¢ä¸­å†å»å®ç°ä¸€éå—ï¼Ÿ

è¿™ä¸ªè‚¯å®šæ˜¯ä¸éœ€è¦çš„ï¼Œå¯¹ä¸å¯¹ã€‚æ‰€ä»¥æˆ‘ä»¬å¸Œæœ›å¯ä»¥å¤ç”¨**ç™»å½•çš„ `UI`**ï¼Œè€Œå¤ç”¨çš„æ–¹å¼åˆ™å¯ä»¥æŠŠ **ç™»å½•çš„ `UI`** å°è£…ç§°ä¸ºä¸€ä¸ª **ç»„ä»¶**

1. åˆ›å»ºç™»å½•ç»„ä»¶ `my-login`
2. åœ¨`my`é‡Œè¾¹ä½¿ç”¨`my-login`ç»„ä»¶

**åœ¨è°ƒç”¨éœ€è¦ç™»å½•æƒé™çš„åŠŸèƒ½æ—¶ï¼Œè¿›å…¥çš„ç™»å½•é¡µé¢** -> æˆ‘ä»¬å…ˆä¸éœ€è¦å»åˆ›å»ºï¼Œç­‰åˆ°ä½¿ç”¨çš„æ—¶å€™ï¼Œå†åˆ›å»ºå°±å¯ä»¥äº†ã€‚

> [Demo](https://github.com/ppambler/imooc-uni-app/commit/dbf9c6f)

4ï¼‰ç”¨æˆ·ç™»å½• - æ˜ç¡®ç™»å½•çš„å®ç°æ€è·¯

åœ¨å®ç°ç™»å½•çš„å…·ä½“åŠŸèƒ½ä¹‹å‰ï¼Œä¸ºäº†é¿å…ä¸€äº›æ²¡æœ‰å¼€å‘ç»éªŒçš„åŒå­¦ç›´æ¥çœ‹ä»£ç ä¸€è„¸æ‡µé€¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¥æ˜ç¡®ä¸€ä¸‹ç™»å½•çš„å®ç°åŸºæœ¬é€»è¾‘ã€‚

é¦–å…ˆå¯¹äºç™»å½•æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šåˆ†ä¸ºä¸¤ä¸ªä¸åŒçš„ç«¯æ¥è¿›è¡Œé€‚é…å®ç°ï¼š

1. å¾®ä¿¡å°ç¨‹åº
2. éå¾®ä¿¡å°ç¨‹åºï¼ˆåœ¨è®²è§£é€‚é…æ—¶å®ç°ï¼‰

æˆ‘ä»¬è¿™é‡Œå…ˆåªè®²è§£ ã€å¾®ä¿¡å°ç¨‹åºçš„å®ç°ã€‘ï¼Œã€éå¾®ä¿¡å°ç¨‹åºã€‘çš„å®ç°å°†åœ¨åé¢çš„ **é€‚é…ç¯èŠ‚è¿›è¡Œ**ã€‚

**å¾®ä¿¡å°ç¨‹åºï¼š**

1. æƒ³è¦å®ç°ç™»å½•åŠŸèƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è°ƒç”¨ç™»å½•æ¥å£æ¥è¿›è¡Œå®ç°ï¼Œè€Œç™»å½•æ¥å£æ‰€éœ€è¦çš„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ `getUserProfile` æ–¹æ³•è¿›è¡Œè·å–ã€‚
2. è°ƒç”¨ç™»å½•æ¥å£æˆåŠŸï¼ŒæœåŠ¡ç«¯ä¼šè¿”å›ç”¨æˆ·çš„ `token`ï¼Œè¿™ä¸ª `token` ä¸ºå½“å‰çš„ç”¨æˆ·èº«ä»½ä»¤ç‰Œã€‚ï¼ˆæ‹¥æœ‰ tokenï¼‰ åˆ™è¡¨ç¤ºç”¨æˆ·å·²ç»ç™»å½•äº†ã€‚
3. è€Œæ­¤å¤„çš„ `token`ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¤šä¸ªç»„ä»¶ä¸­è¿›è¡Œä½¿ç”¨ï¼Œæ‰€ä»¥ `token` éœ€è¦è¢«ä¿å­˜åˆ° `å…¨å±€çŠ¶æ€ç®¡ç†å·¥å…· - vuex` ä¸­ï¼ŒåŒæ—¶éœ€è¦ä¿å­˜çš„è¿˜æœ‰é€šè¿‡ `getUserProfile` è·å–åˆ°çš„ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€‚
4. è€Œå½“å‰çš„ç”¨æˆ·ç™»å½•çŠ¶æ€ï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥ä¸€ç›´ä¿å­˜ï¼ˆPSï¼šä¸éœ€è¦æ¯æ¬¡éƒ½è¿›è¡Œç™»å½•ï¼‰ã€‚æ‰€ä»¥åœ¨ç™»å½•å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦æŠŠ **`token` å’Œ `userinfo`** ä¿å­˜åˆ° **æœ¬åœ°å­˜å‚¨ä¸­**
5. æœ€åï¼Œä¸ºäº†å®ç° **æ•°æ®ä¸ç»„ä»¶çš„åˆ†ç¦»**ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä¸ **ä¸ç™»å½•ç›¸å…³çš„é€»è¾‘** éƒ½å°è£…åœ¨ `vuex` ä¸­è¿›è¡Œã€‚

è¿™äº›ä¸šåŠ¡æ˜¯ **å‰ç«¯ç”¨æˆ·ç™»å½•çš„æ ‡å‡†é€»è¾‘**ï¼Œå¤§å®¶åœ¨ä»¥åçš„å‰ç«¯ç™»å½•ä¸šåŠ¡å¤„ç†ä¸­ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§æ­¤é€»è¾‘è¿›è¡Œã€‚

é‚£ä¹ˆä»ä¸‹ä¸€å°èŠ‚å¼€å§‹ï¼Œæˆ‘ä»¬å°±æŒ‰ç…§è¿™ä¸ªé€»è¾‘å®ç°ä¸€ä¸‹å¯¹åº”çš„ä»£ç ã€‚

5ï¼‰ç”¨æˆ·ç™»å½• - å°è£… action è°ƒç”¨ç™»å½•æ¥å£

åœ¨ä¸Šä¸€å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬åˆ†æäº†ã€å¾®ä¿¡å°ç¨‹åºã€‘ä¸­è¿›è¡Œç™»å½•çš„å®ç°é€»è¾‘ï¼Œé‚£ä¹ˆä»è¿™ä¸€å°èŠ‚å¼€å§‹ï¼Œæˆ‘ä»¬å°±å®ç°å¯¹åº”çš„åŠŸèƒ½ã€‚

![ç™»å½•æµç¨‹](assets/img/2021-12-27-23-12-11.png)

å®ç°ï¼š

1. åœ¨`api/user.js`é‡Œè¾¹å®šä¹‰`login`å‡½æ•°ï¼Œç”¨æ¥å‘é€`POST`è¯·æ±‚ï¼Œè¯·æ±‚åœ°å€æ˜¯`'/sys/login'`ï¼Œä¼ é€’çš„æ•°æ®æ˜¯ã€Œç”¨æˆ·ä¿¡æ¯ã€
2. åœ¨`my-login`é‡Œè¾¹å®šä¹‰`getUserInfo`æ–¹æ³•ï¼Œç”¨æ¥è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ä¸ªä¿¡æ¯æ˜¯å¾®ä¿¡ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ -> æŠŠè¿™ä¸ªç”¨æˆ·ä¿¡æ¯äº¤ç»™åœ¨`vuex`é‡Œè¾¹å®šä¹‰çš„`login`æ–¹æ³•ï¼Œç”¨ä½œç™»å½•æ—¶çš„è¯·æ±‚å‚æ•°
3. åœ¨`store/user.js`é‡Œè¾¹å®šä¹‰`user`æ¨¡å—ï¼Œåœ¨`store/index.js`é‡Œè¾¹æ³¨å†Œ`user`æ¨¡å—ï¼Œåœ¨`my-login`é‡Œè¾¹é€šè¿‡`mapActions`æ³¨å†Œ`user`æ¨¡å—çš„`login`æ–¹æ³•

> [Demo](https://github.com/ppambler/imooc-uni-app/commit/d935742)

6ï¼‰ç”¨æˆ·ç™»å½• - ä¿å­˜ç”¨æˆ·ç™»å½•çŠ¶æ€
