### ✍️ Tangxt ⏳ 2021-12-15 🏷️ uni-app

# 05-uniapp 开发 ImoocBlog

1）开篇

经过前面四个章节，我们已经完成了 **微信小程序** 的学习。那么从这一章开始我们就进入 `uniapp` 的项目开发之中。

整个 `uniapp` 阶段我们会完成一个正式的项目 **慕课热搜** ，以这个项目来作为 `uniapp` 学习阶段的的最终产出，同时通过这个项目来贯穿所有的 `uniapp` 知识点，可以让大家在学习的过程中不至于那么枯燥。

目前我们的项目已经上线了：

1. 微信小程序：微信 -> 发现 -> 小程序 -> 搜索《慕课热搜》
2. `H5` ：`https://imooc.blog.lgdsunday.club/#/`

那么现在：

- html、css、js、微信小程序，等基础知识
- 接口文档、最终效果、等各种项目需求

各种前置条件已经全部准备就绪，项目开发即可开始！

2）uniapp 难吗？

1、引言

《慕课热搜》基于 `uniapp` 进行开发，关于 `uniapp` 的优点 -> 在【课程导学】阶段已经描述过了，如果你忘了，那么你可以回过头去看一下。

这一小节我们来点实在的，光知道它好，不行。因为不是你的，它再好，对你而言也是没啥用的……

那么怎么才能学会它呢？或者说它难学吗？这才是这一小节我们需要说明的内容。

2、内容

[点击这里直接进入 uniapp 官网](https://uniapp.dcloud.io/)

想要学习 `uniapp` 那么需要有三个前置条件：

> 具备了这 3 个条件，学习 uni-app ，对你而言就是小菜一碟

1. `html + css + js`： 这个相信大家都没有问题
2. 微信小程序：这个我们已经在前面的章节非常详细的为大家讲解过了 -> uni-app 借鉴了很多小程序的内容
3. `vue`：可能有很多同学一看这个，心就凉了一截。我不会 `vue` 咋办啊。.. 
   没有关系！
   我敢把这个列出来，肯定就已经为大家想到了这么一点。
   `vue` 的理念和 **微信小程序** 的理念有非常多相同的地方，在我们后面进行项目开发的过程中，遇到一些个别的语法时，我会为大家进行介绍的。

总之，对于大家来说，这三个条件，如果你全部具备，那自然是最好的。

如果你只具备前两个条件，也不要担心，甚至可以说是更加幸运 -> 为啥这么说？ -> 因为接下来你将会在学会 `uniapp` 的同时，也会掌握 `vue` 的核心使用！

> 学会 uni-app 难吗？ -> uni-app 的语法可以简单理解成「vue 语法」和「小程序语法」的结合体 -> 这显然不难！

3）配置 uniapp 开发环境

之前开发微信小程序之前，需要：

1. 申请小程序账号
2. 下载微信小程序开发工具

同样，在进行 uniapp 开发之前，我们也需要做类似这样的事情，也就是需要配置项目的开发环境

uniapp 项目的开发环境主要有两点：

- 下载并安装开发者工具 HBuilder X
- 安装 sass 依赖 -> 项目需要用到 sass 语法

1、下载并安装开发工具

1. `uniapp` 同样提供了一个专门的开发工具 `HBuilder X` -> [HBuilderX 下载页面](https://www.dcloud.io/hbuilderx.html)
2. 点击 `DOWNLOAD` 
3. 选择 `App 开发版本`（因为我们要实现是慕课热搜） -> 推荐使用正式版
4. `Windows` 版本下载完成之后会得到一个 `zip` 的压缩包文件，解压完成即可使用 -> 是一个便携版
5. `MacOS` 版本下来完成会得到一个 `dmg` 的安装包，直接安装即可

2、安装 `sass` 依赖

因为我们的项目开发会使用 `sass`，所以需要为 `HBuilder X` 安装 `sass 编译器`。

1. 打开 `HBuilder X`
2. 打开插件地址：<https://ext.dcloud.net.cn/plugin?id=2046> -> 要登录账号，没有账号，那就注册
   1. 点击【使用 `HBuilderX` 导入插件】 -> 一定要去掉你浏览器的广告插件，不然，这是不会出现这个按钮的
   2. 在弹出框中点击【打开 `HBuilderX`】
3. 点击【是】
4. 此时会在 `HBuilderX` 右下角，提示你【正在下载】
5. 等待完成即可

![安装插件](assets/img/2021-12-15-18-24-02.png)

4）创建 imooc-blog

本小节做两件事：

1. 创建项目 -> 开发工具会自动帮我们生成目录结构，就像微信小程序开发者工具一样
2. 了解项目基本组成结构

1、创建 uni-app 项目

打开 HBuilderX -> 文件 -> 新建 -> 项目：

![创建项目](assets/img/2021-12-15-18-57-35.png)

效果：

![效果](assets/img/2021-12-15-19-05-18.png)

2、项目目录介绍

```html
├─pages            // 页面存放文件夹，等同于 微信小程序中的 pages
│  └─index.vue     // 默认生成的页面
├─static           // 静态资源存放文件夹
└─uni_modules      // uni-app 组件目录
│  └─uni-xxx       // uni-app 所提供的业务组件，等同于 微信小程序中的组件
├─App.vue          // 应用配置文件，用来配置全局样式、生命周期函数等，等同于 微信小程序中的 app.js
└─main.js          // 项目入口文件 -> 初始化 Vue
├─mainfest.json    // 配置应用名称、appid、logo、版本等打包信息，
└─pages.json       // 配置页面路径、窗口样式、tabBar 等页面类信息，等同于 微信小程序中的 app.json
└─uni.scss         // uni-app 内置的常用样式变量
```

5）运行项目到 微信开发者工具

**`uniapp` 支持 10 个平台，我们以 微信小程序 和 `h5` 平台为例子，进行演示。**

> 为啥只适配这两个端？ -> 因为其它平台很少使用，比如 360 小程序

1、运行到 微信小程序

1. 配置【微信开发工具】路径：工具 -> 设置
2. 设置【微信开发工具路径】：运行配置 -> 微信开发者工具路径 -> 输入微信开发者工具的安装路径，如「`D:/微信 web 开发者工具`」
3. **切记：** 一定要在 `HBuilder X` 中双击打开你项目中的某一个文件（比如：`App.vue`）
4. 运行到微信小程序：运行 -> 运行到小程序模拟器 -> 微信开发者工具
5. 底部会提示编译
6. 编译成功，微信小程序自动启动

第一个问题：

![问题](assets/img/2021-12-15-20-03-13.png)

在小程序开发者工具里边，把安全设置的服务端口给开启了：

![开启端口](assets/img/2021-12-15-20-06-38.png)

> [【报 Bug】无法打开微信小程序开发者工具 - DCloud 问答](https://ask.dcloud.net.cn/question/65922)

打开 IDE 成功：

![IDE](assets/img/2021-12-15-20-08-05.png)

效果：

![效果](assets/img/2021-12-15-20-08-50.png)

2、运行到浏览器

1. **切记：** 一定要在 `HBuilder X` 中双击打开你项目中的某一个文件（比如：`App.vue`） -> 不然浏览器是不认识的
2. 无需配置，直接运行：运行 -> 运行到浏览器 -> Chrome
3. 编译完成，浏览器自动打开，运行成功

![运行到浏览器](assets/img/2021-12-15-20-15-10.png)

> 一般切换到手机调试模式

---

> 在实际项目开发中，微信小程序占据了绝大多数的用户，而 H5 端是我们 web 前端常见的一种形式，所以，在以后的正常开发之中，我们项目多以微信小程序和 H5 端的适配为主

6）使用 VSCode 开发 uniapp

虽说 `HBuilder X` 开发体验还算不错，但是有时候金窝银窝不如自己的狗窝，当我们习惯了 `VSCode` 之后，有时候不太愿意换开发工具。

那么怎么使用 `VSCode` 来开发 `uniapp` 呢？ 其实是有办法的。

1. 使用 `HBuilder X` 运行项目（运行方式，参考上一小节）
2. 使用 `VSCode` 打开项目
3. 在 `VSCode` 中安装插件：
   1. [uni-helper](https://marketplace.visualstudio.com/items?itemName=ModyQyW.vscode-uni-helper) - 让开发者在 VSCode 中开发 `uni-*` 的体验尽可能好。
   2. [uni-app-snippets](https://marketplace.visualstudio.com/items?itemName=ModyQyW.vscode-uni-app-snippets) - 支持 uni-app 基本能力的代码片段，包括组件和 API
   3. [uni-app-schemas](https://marketplace.visualstudio.com/items?itemName=ModyQyW.vscode-uni-app-schemas) - 支持 uni-app `pages.json` 和 `manifest.json` 简单的格式校验
   4. [uni-ui-snippets](https://marketplace.visualstudio.com/items?itemName=ModyQyW.vscode-uni-ui-snippets) - 支持 uni-ui 组件代码片段
4. 在 `VSCode` 中修改代码，运行结果自动发生变化

> 让 `HBuilder X` 作为中介，我们在 VSCode 中写代码 -> 为了提高自己的开发体验（比如 API 提示等），可以安装插件 -> 安装一个`uni-helper`插件，其它三个插件自动安装

💡：uniapp 的 uni_modules 目录需要提交到 Git 吗？

需要提交！

7）创建与配置 tabBar

目前，项目的运行以及开发环境都搞定了，就下来我们要做的就是开发这个项目！

> 先搞定这个项目的结构 -> 也就是 tabBar 切换 -> uniapp 模仿微信小程序，也就是创建姿势，跟微信小程序一样

1、创建页面

> 把默认的页面删了，由于安装了插件，VSCode 也可以右键目录名创建页面 -> 但建议还是用 HBuilder 创建页面

1. 删除 `pages` 下的 `index` 文件夹
2. 在 `pages` 文件夹处，右键 -> 选择新建页面
3. 确认新建页面的信息
4. 点击创建按钮完成新建
5. 循环以上顺序，依次完成 `hot`、`hot-video`、`my` 三个页面的创建

![新建页面](assets/img/2021-12-16-17-16-20.png)

效果：

![创建页面](assets/img/2021-12-16-17-17-49.png)

2、配置 `pages.json`

1. 删除 `index` 路径
2. 新建 `tabBar` 节点
3. 复制 **资源** 文件夹下 `tab-icons` 文件夹到 `static` 文件夹中 -> 删掉原先存在的图片
4. 编写`tabBar`代码
5. 如果修改完成之后，依然得到了以下错误，那么可以在 `HBuilder X` 中重新运行项目到微信开发者工具解决 -> 这是小程序开发者工具的 bug（无法更新已经删除了文件这种情况，似乎有缓存啊） -> 重新运行项目就可以解决这个 bug 了
   
   ![bug](assets/img/2021-12-16-17-32-24.png)
   

完整`tabBar`代码：

![代码](assets/img/2021-12-16-17-34-05.png)

效果：

![效果](assets/img/2021-12-16-17-34-45.png)

8）警告与错误处理

1、解决 【sitemap 索引情况提示】的警告问题

![警告问题](assets/img/2021-12-16-17-38-03.png)

微信小程序默认开启了索引功能，但是因为我们没有配置索引策略，导致出现了这么一个警告的问题。具体情况可以参考：<https://developers.weixin.qq.com/miniprogram/dev/framework/sitemap.html>

而如果想要解决这个警告也非常简单，因为一般情况项目不需要被微信索引，所以我们只需要 **关闭** 默认索引功能即可！

![索引问题](assets/img/2021-12-16-17-44-34.png)

> 双击打开 `manifest.json` -> 点击源码视图 -> 下翻找到 `mp-weixin` 配置节点 -> 在 `settings` 下新增 `"checkSiteMap" : false`

2、解决 ` Cannot read property 'forceUpdate' of undefined` 的错误

![forceUpdate](assets/img/2021-12-16-17-46-20.png)

这个错误的原因非常简单 -> 因为我们没有为项目配置 `AppID` 的原因，所以只需要完成 `AppID` 配置即可。 -> 我们说过开发一个微信小程序项目，首先得有微信开发者工具，其次得有`AppId`

![AppID](assets/img/2021-12-16-17-54-37.png)

---

错误处理完成后，就可以进入到我们的页面开发了！

9）热搜页面分析


