### âœï¸ Tangxt â³ 2022-04-17 ðŸ·ï¸ å°ç¨‹åº

# 09-æ’­æ”¾å™¨æš‚åœã€ä¸Šâ¼€â¾¸ã€ä¸‹â¼€â¾¸ã€è¿›åº¦æŽ§åˆ¶

1ï¼‰ç­”ç–‘

ðŸ’¡ï¼šä»Ž tabbar é¡µé¢è·³è½¬åˆ°å…¶å®ƒæ™®é€šé¡µé¢ -> å†ä»Žæ™®é€šé¡µé¢è¿”å›žåˆ°è¿™ä¸ª tabbar é¡µé¢æ—¶éœ€è¦åˆ·æ–°è¿™ä¸ª tabbar é¡µé¢ï¼Ÿ

ç›‘å¬è¿”å›ž -> ç”¨äº‹ä»¶æ€»çº¿ç›‘å¬æŸä¸ªäº‹ä»¶

ä¹Ÿå¯ä»¥ç”¨`onShow`ï¼ˆé¡µé¢é‡æ–°å‡ºçŽ°ï¼‰

æ ¹æ®éœ€æ±‚é€‰æ‹©æ–¹æ¡ˆ

ðŸ’¡ï¼šCSS é€‰æ‹©å™¨è­¦å‘Šï¼Ÿ

å¯ä»¥ä¸å¤„ç†ï¼Œåªæ˜¯å®ƒä¸æŽ¨èä½¿ç”¨åƒ`image`è¿™æ ·çš„æ ‡ç­¾é€‰æ‹©å™¨ç½¢äº†ï¼

ðŸ’¡ï¼šå†™æ ·å¼çš„å¿«æ…¢

- ç¡®å®šäº†å¸ƒå±€ -> å†™æ ·å¼å¾ˆå¿«
- å†™æ ·å¼å¾ˆçº ç»“ -> æ ·å¼å°±å†™å¾—å¾ˆæ…¢äº†

ðŸ’¡ï¼šæ’­æ”¾é¡µçš„è®¾è®¡å›¾ï¼Ÿ

å¯ä»¥è‡ªå·±è®¾è®¡ -> æ¯”å¦‚æŠŠå›¾ç‰‡æ¢æˆæ˜¯åœ†çš„ -> æ—©æœŸ QQ éŸ³ä¹å°±æ˜¯åœ†çš„

2ï¼‰ç†è§£æ’­æ”¾é¡µ-é¡µé¢å¸ƒå±€çš„è®¾è®¡è°ƒæ•´

> ä¼˜åŒ–ï¼šå°å±å¹•ä¸å±•ç¤ºæ­Œè¯ï¼Œå¤§å±å¹•å±•ç¤ºæ­Œè¯

ðŸ’¡ï¼šåœ¨å°å±å¹•ï¼Œå¦‚ iP5ï¼Œæ­Œè¯ä¸æ˜¾ç¤ºå¦‚ä½•åšï¼Ÿ

å¯¹å›¾ç‰‡ä½¿ç”¨`aspectFill`çš„æƒ…å†µï¼š

![aspectFill](assets/img/2022-04-19-16-59-03.png)

æˆ‘ä»¬å¯¹å›¾ç‰‡ä½¿ç”¨`widthFix`ï¼š

![widthFix](assets/img/2022-04-19-16-54-47.png)

å±å¹•é«˜äº† -> å½±å“åº•éƒ¨å¸ƒå±€ -> å±å¹•å®½äº†ï¼Œå›¾ç‰‡ä¹Ÿé«˜äº†ï¼Œä¹Ÿå½±å“åº•éƒ¨å¸ƒå±€

æ ¹æ®è®¾å¤‡çš„å®½é«˜æ¯”æ¥å†³å®šæ˜¯å¦æ˜¾ç¤ºæ­Œè¯ -> `è®¾å¤‡é«˜åº¦ / è®¾å¤‡å®½åº¦`

æ¯”ä¾‹æ˜¯è¶…è¿‡ 2 å°±æ˜¾ç¤ºæ­Œè¯ï¼Œä¸è¶…è¿‡å°±éšè—æ­Œè¯

iP5 å’Œ iP6 éƒ½ä¼šä½ŽäºŽ 2 çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æ˜¾ç¤ºæ­Œè¯

![æ•ˆæžœ](assets/img/2022-04-19-17-24-23.png)

> [Demo](https://github.com/ppambler/QQMusic/commit/287d34f)

> 2 22 09

ä»¥åŽé‡åˆ°è¿™æ ·çš„è®¾è®¡é—®é¢˜ï¼Œéƒ½å¯ä»¥è¿™æ ·åšï¼Œå½“ç„¶ï¼Œäº§å“ä¼šç»™å‡ºå…·ä½“çš„å¸ƒå±€æ–¹æ¡ˆ

3ï¼‰æŽŒæ¡æ’­æ”¾é¡µ-ç•Œé¢æ•°æ®ä¼˜åŒ– å’Œ audioContext ä¼˜åŒ–

ðŸ’¡ï¼šç›®å‰çš„é—®é¢˜ï¼šä¸ç®¡ç‚¹å‡»è°ï¼Œè¿™è¿›å…¥çš„éƒ½æ˜¯ä¸€æ ·çš„é¡µé¢

![é¡µé¢](assets/img/2022-04-19-17-50-10.png)

æ‰€ä»¥éœ€è¦åŠ¨æ€åŒ–è¿™äº›æ•°æ®

ðŸ’¡ï¼šå¦‚ä½•èŽ·å–æ­Œæ›²æ€»æ—¶é•¿ï¼Ÿ

æœ‰ä¸¤ç§æ–¹æ¡ˆï¼š

1. `audioContext`æœ‰ä¸ª`duration`å¯ä»¥èŽ·å–æ­Œæ›²æ€»æ—¶é•¿ï¼Œä¸è¿‡éœ€è¦ç­‰æ­Œæ›²æ’­æ”¾åŽæ‰èƒ½èŽ·å–åˆ°
2. æŽ¥å£ä¼šè¿”å›žæœ‰å…³æ­Œæ›²æ€»æ—¶é•¿çš„å­—æ®µ -> æ¯”å¦‚`dt`å­—æ®µï¼ˆ`duration`çš„ç¼©å†™ï¼‰

æœåŠ¡å™¨ç»™äº†å­—æ®µé‚£å°±é€‰æ‹©æ–¹æ¡ˆ 2ï¼Œæ²¡ç»™ï¼Œé‚£å°±é€‰æ‹©æ–¹æ¡ˆ 1

ðŸ’¡ï¼šå¦‚ä½•èŽ·å–å½“å‰æ­Œæ›²æ­£åœ¨æ’­æ”¾åˆ°çš„æ—¶é—´ï¼Ÿ

è¿™ä¸ªæ—¶é—´ä¸å¥½æ‹¿

ðŸ’¡ï¼šä¼˜åŒ–ï¼šæˆ‘ä»¬åªéœ€åˆ›å»ºä¸€ä¸ªæ’­æ”¾å™¨å°±å¥½äº†ï¼ŒåŒä¸€æ—¶åˆ»åªä¼šæ’­æ”¾ä¸€é¦–æ­Œ

![æ’­æ”¾å™¨](assets/img/2022-04-19-19-20-06.png)

æ’­æ”¾å™¨ä¸æ­¢åœ¨ä¸€ä¸ªåœ°æ–¹ä½¿ç”¨ï¼Œè¿˜ä¼šåœ¨å…¶å®ƒåœ°æ–¹ä½¿ç”¨ -> éœ€è¦å…±äº«è¿™ä¸ªå¯¹è±¡

æœ‰ä¸¤ä¸ªæ–¹æ¡ˆï¼š

1. `app.js`
2. `event-store`

é€‰æ‹©è°ï¼Ÿ -> å–å†³äºŽè¿™ä¸ªå¯¹è±¡æœ‰ä¸€å¤©ä¼šä¸ä¼šè¢«ä¿®æ”¹ï¼Œç„¶åŽä¿®æ”¹åŽæ˜¯å¦ä¼šå¼•èµ·ç•Œé¢çš„å˜åŒ– -> ä¹Ÿå°±æ˜¯æ ¹æ®æ•°æ®å˜åŒ–ä½œå‡ºå“åº”å¼ï¼ˆæ¯”å¦‚ UI å¸ƒå±€å˜åŒ–ç­‰ï¼‰

ä¹‹åŽè¦å…±äº«çš„æ•°æ® -> æ­Œè¯ã€å½“å‰æ’­æ”¾æ—¶é—´ã€æ­Œæ›²

ä¸é€‰æ‹©æ–¹æ¡ˆ 1 -> å› ä¸ºæˆ‘ä»¬è¿˜ç”¨åˆ©ç”¨`audioContext`æ——ä¸‹çš„ API åŽ»ç›‘å¬ä¸€äº›äº‹å„¿ï¼Œåœ¨`app.js`é‡Œè¾¹å†™çš„è¯ï¼Œä¼šè®©è¿™ä¸ªæ–‡ä»¶å¾ˆå¤§å¾ˆæ··ä¹±

æˆ‘ä»¬çš„åšæ³•æ˜¯ -> æ”¾åˆ°ä¸€ä¸ª`js`æ–‡ä»¶é‡Œè¾¹ -> ç»Ÿä¸€åœ¨è¿™ä¸ªæ–‡ä»¶å¤„ç†æœ‰å…³`audioContext`çš„é€»è¾‘

![æ–¹æ¡ˆ 3](assets/img/2022-04-19-19-30-33.png)

è¿™ç§åšæ³•ï¼Œå¯ä»¥ç»“åˆ`event-store`

---

æ•ˆæžœï¼š

![æ•ˆæžœ](assets/img/2022-04-19-20-21-14.png)

> æœ‰äº›åœ°æ–¹ä¸“è¾‘é‚£éƒ¨åˆ†æ²¡æœ‰æ•°æ®

> [Demo](https://github.com/ppambler/QQMusic/commit/50674c6)

ðŸ’¡ï¼šæµåª’ä½“

![æ’­æ”¾](assets/img/2022-04-19-19-42-10.png)

æ’­æ”¾çš„æ—¶å€™ï¼Œ`audioContext.src`éœ€è¦èŽ·å–æµåª’ä½“æ•°æ®ï¼ˆå°è£…æ ¼å¼ã€ç¼–ç æ ¼å¼ï¼‰ -> è§£ç  -> æ’­æ”¾

> ä¸éœ€è¦ç¼“å­˜å®Œæ‰ä¼šæ’­æ”¾ï¼Œä¼šè¾¹ç¼“å­˜è¾¹æ’­æ”¾

éœ€è¦å­¦ c  -> ä¸€ä¸ªå¾ˆé‡è¦çš„åº“ `FFmpeg`

è€å¸ˆ coderwhy ç®€ä¹¦æœ‰ä»‹ç»

è¿™ä¸ªæµåª’ä½“ä¸å±žäºŽå‰åŽç«¯ï¼Œä¹Ÿä¸å±žäºŽç§»åŠ¨ç«¯ï¼Œå°±æ˜¯æµåª’ä½“è¿™ä¸ªé¢†åŸŸçš„çŸ¥è¯† -> æœªæ¥ä¼šå¾ˆç«

å†™ç®€å•åº”ç”¨çš„è¯ï¼Œä¸ç”¨å­¦ c å’Œ c++ -> æœ‰äº›åº“åº•å±‚æœ‰å°è£…

âž¹ï¼š[å‰ç«¯æµåª’ä½“æ’­æ”¾ä»Žå…¥é—¨åˆ°å…¥å‘ - æŽ˜é‡‘](https://juejin.cn/post/7015100196631609351)

4ï¼‰

ðŸ’¡ï¼šè¿›åº¦æŽ§åˆ¶

å¾—åˆ°æ’­æ”¾çš„å½“å‰æ—¶é—´ï¼š

1. æ˜Žç¡®çŸ¥é“æ­Œæ›²æ’­æ”¾åˆ°ä»€ä¹ˆæ—¶é—´
2. `audioContext`æä¾›äº†ä¸€ä¸ªå«`onTimeUpdate`çš„é’©å­ -> `on`å¼€å¤´çš„å‡½æ•°å‘½åï¼Œä¸€èˆ¬æ˜¯æŒ‡åœ¨ä»€ä¹ˆä»€ä¹ˆæƒ…å†µä¸‹ä½ å‡†å¤‡åšä¸€ä»¶äº‹æƒ…çš„æ—¶å€™ï¼ˆä¸ç®¡æ˜¯åš Java å¼€å‘è¿˜æ˜¯å…¶å®ƒå¼€å‘éƒ½æ˜¯å¦‚æ­¤ï¼‰ ->æˆ‘ä»¬ç›‘å¬åœ¨æ—¶é—´å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦åšä¸€ä»¶äº‹
3. `audioContext`æœ‰ä¸ª`currentTime`å±žæ€§ï¼Œå¯ä»¥æ‹¿åˆ°å½“å‰æ’­æ”¾çš„æ—¶é—´ -> å¾—åˆ°æ˜¯`s` -> æˆ‘ä»¬æ ¼å¼åŒ–çš„æ˜¯`ms`

æ‹–åŠ¨è¿›åº¦å¯ä»¥æ”¹å˜æ—¶é—´ï¼Œæ—¶é—´å˜åŒ–å¯ä»¥è‡ªåŠ¨æ‹–åŠ¨è¿›åº¦ï¼š

æˆ‘ä»¬æ‰‹åŠ¨æ‹–åŠ¨è¿›åº¦çš„æƒ…å†µ -> åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š

1. ç‚¹åˆ°å“ªä¸ªä½ç½®ï¼Œå°±ç«‹é©¬æ’­æ”¾å“ªä¸ªä½ç½® -> ç›‘å¬`bindchange`äº‹ä»¶
2. æ¥å›žæ‹–æ‹½è¿›åº¦æ¡ -> ä¸å½±å“åŽŸæ¥æ­Œæ›²çš„æ’­æ”¾èŠ‚å¥ -> ç­‰åˆ°æ¾æ‰‹æ—¶ï¼Œæ‰æ’­æ”¾åœ¨è¿™ä¸ªä½ç½®æ—¶çš„æ­Œæ›² -> ç›‘å¬`bindchanging`äº‹ä»¶ï¼Œæœ€åŽç›‘å¬`bindchange`äº‹ä»¶

è®©è¿›åº¦æ¡éšç€æ­Œæ›²æ’­æ”¾è‡ªåŠ¨æ‹–åŠ¨ï¼š

- å½“å‰æ—¶é—´å’Œæ€»æ—¶é•¿çš„å æ¯” -> ä¹˜ä¸Š 100 -> `slider`çš„å€¼æ˜¯`0-100`




