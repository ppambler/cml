### âœï¸ Tangxt â³ 2022-05-17 ðŸ·ï¸ å°ç¨‹åº

# 13-é¡¹â½¬ä¸Šçº¿å‘å¸ƒæµç¨‹è§£æž

1ï¼‰ç­”ç–‘

ðŸ’¡ï¼šçœ‹ redux çš„ä½¿ç”¨å¾ˆéš¾ï¼Œä½†çœ‹å®ƒçš„æºç å¹¶ä¸éš¾

è¿™ä¸ªæºç çœ‹æ‡‚äº†ï¼Œé‚£ä¹ˆä½ å†çœ‹å…¶å®ƒæ¡†æž¶çš„æºç ï¼Œä½ ä¼šå‘çŽ°è¿™å¹¶ä¸éš¾

ðŸ’¡ï¼šJS é«˜çº§ä¸ºå•¥ä¸è®² svgã€canvasï¼Ÿ

å®ƒä»¬å±žäºŽæµè§ˆå™¨åŠŸèƒ½ï¼Œä¸å±žäºŽè¯­è¨€æœ¬èº«

ðŸ’¡ï¼š`node_modules`é‡Œè¾¹çš„ä¸œè¥¿æ˜¯æºç å—ï¼Ÿ

å¤§éƒ¨åˆ†æ˜¯æºç ï¼Œæœ‰äº›åˆ™æ˜¯æ‰“åŒ…åŽçš„ -> ä½ å‘å¸ƒçš„æ˜¯ä»€ä¹ˆï¼Œé‚£å°±æ˜¯ä»€ä¹ˆ

2ï¼‰æŽŒæ¡ç™»å½•-ç™»å½•ä»£ç é€»è¾‘çš„ä¼˜åŒ–

ðŸ’¡ï¼šåˆ†åŒ…

é¡¹ç›®æºä»£ç è¿‡å¤šï¼Ÿ -> é‚£å°±é‡‡ç”¨åˆ†åŒ…å§ï¼

æŠŠé¦–æ¬¡å¯åŠ¨ä¸éœ€è¦åŠ è½½çš„ä¸œè¥¿ï¼Œå•ç‹¬æ”¾åˆ°ä¸€ä¸ªåŒ…é‡Œ -> å•ç‹¬åŠ è½½

ç±»ä¼¼çš„å®žçŽ° -> è·¯ç”±æ‡’åŠ è½½

ðŸ’¡ï¼š`session_key`çš„æœ‰æ•ˆæœŸ

æœ‰æ•ˆæœŸæ˜¯å¤šå°‘æ˜¯ä¸ç¡®å®šçš„ -> å°ç¨‹åºä½¿ç”¨è¶Šé¢‘ç¹ï¼Œé‚£ä¹ˆå®ƒçš„æœ‰æ•ˆæœŸè¶Šä¹…ï¼Œä¹Ÿå°±æ˜¯è¯´å°ç¨‹åºé•¿æ—¶é—´æ²¡æœ‰ç™»å½•çš„è¯ï¼Œé‚£å°±éœ€è¦æ¢å–æ–°çš„`session_key`äº†

ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯åŽç«¯æ“ä½œ

å‰ç«¯æ‰€è¦åšçš„æ“ä½œæ˜¯å¾ˆå°‘çš„ï¼ -> å‰ç«¯åªéœ€è¦å‘èµ·ä¸€ä¸ªè¯·æ±‚å°±å¯ä»¥äº†ï¼

ðŸ’¡ï¼šä¼˜åŒ–ä»£ç 

![ä»£ç ä¼˜åŒ–](assets/img/2022-05-18-19-39-04.png)

ä¼˜åŒ–ï¼š

![ä¼˜åŒ–](assets/img/2022-05-18-19-40-52.png)

ðŸ’¡ï¼šç»§ç»­ä¼˜åŒ–ä»£ç 

![ä»£ç ä¼˜åŒ–](assets/img/2022-05-18-19-44-47.png)

æ”¹é€ `HYRequest`è¿™ä¸ª`Class` -> ç›®çš„ï¼šä¸º`HYRequest`å¤šæ·»åŠ ç‚¹ä¸œè¥¿ï¼Œè®©æˆ‘ä»¬åœ¨å…¶å®ƒåœ°æ–¹åšæ›´å°‘çš„äº‹å„¿ -> ç®€å•æ¥è¯´ï¼Œ`HYRequest`æ›´å¤æ‚ä¸€ç‚¹ï¼Œé‚£ä¹ˆåˆ«äººåœ¨ç”¨è¿™ä¸ª`HYRequest`åšæŸäº›äº‹å„¿çš„æ—¶å€™å°±ä¼šæ›´ç®€å•äº†ï¼Œæ¯”å¦‚`token`çš„ä¼ é€’

`baseHeader`ï¼Ÿ`authHeader`ï¼Ÿ -> èµ·å

å‰è€…éƒ½éœ€è¦ï¼ŒåŽè€…åªæ˜¯éƒ¨åˆ†éœ€è¦

![class](assets/img/2022-05-18-20-00-53.png)

``` js
// isAuth å¯æŽ§åˆ¶ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¦è¢«æºå¸¦ä¸Š
const hyLoginRequest = new HYRequest(LOGIN_BASE_URL, {
  token
})
```

ä¼˜åŒ–å¥½åŽçš„ä½¿ç”¨ï¼š

![ä½¿ç”¨](assets/img/2022-05-18-19-54-53.png)

è™½ç„¶éƒ½æ˜¯ç”¨`hyLoginRequest`è¿™ä¸ªå®žä¾‹ï¼Œä½†æ˜¯è¿™ä¸ªå®žä¾‹ä¸‹å‘èµ·çš„è¯·æ±‚ï¼Œæœ‰äº›æ˜¯ä¸éœ€è¦æƒé™ï¼Œä¹Ÿå°±æ˜¯ä¸éœ€è¦`token`

å¹¶ä¸æ˜¯è¯´ï¼Œç”¨äº†`hyLoginRequest`ï¼Œé‚£ä¹ˆç”¨å®ƒå‘èµ·çš„è¿™ä¸ªè¯·æ±‚å°±å¿…ç„¶ä¼šæºå¸¦ä¸Š`token`

---

> [Demo](https://github.com/ppambler/QQMusic/commit/b9c56ac)

3ï¼‰













