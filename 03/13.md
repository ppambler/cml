### ✍️ Tangxt ⏳ 2022-05-17 🏷️ 小程序

# 13-项⽬上线发布流程解析

1）答疑

💡：看 redux 的使用很难，但看它的源码并不难

这个源码看懂了，那么你再看其它框架的源码，你会发现这并不难

💡：JS 高级为啥不讲 svg、canvas？

它们属于浏览器功能，不属于语言本身

💡：`node_modules`里边的东西是源码吗？

大部分是源码，有些则是打包后的 -> 你发布的是什么，那就是什么

2）掌握登录-登录代码逻辑的优化

💡：分包

项目源代码过多？ -> 那就采用分包吧！

把首次启动不需要加载的东西，单独放到一个包里 -> 单独加载

类似的实现 -> 路由懒加载

💡：`session_key`的有效期

有效期是多少是不确定的 -> 小程序使用越频繁，那么它的有效期越久，也就是说小程序长时间没有登录的话，那就需要换取新的`session_key`了

不过，这些都是后端操作

前端所要做的操作是很少的！ -> 前端只需要发起一个请求就可以了！

💡：优化代码

![代码优化](assets/img/2022-05-18-19-39-04.png)

优化：

![优化](assets/img/2022-05-18-19-40-52.png)

💡：继续优化代码

![代码优化](assets/img/2022-05-18-19-44-47.png)

改造`HYRequest`这个`Class` -> 目的：为`HYRequest`多添加点东西，让我们在其它地方做更少的事儿 -> 简单来说，`HYRequest`更复杂一点，那么别人在用这个`HYRequest`做某些事儿的时候就会更简单了，比如`token`的传递

`baseHeader`？`authHeader`？ -> 起名

前者都需要，后者只是部分需要

![class](assets/img/2022-05-18-20-00-53.png)

``` js
// isAuth 可控制第二个参数是否被携带上
const hyLoginRequest = new HYRequest(LOGIN_BASE_URL, {
  token
})
```

优化好后的使用：

![使用](assets/img/2022-05-18-19-54-53.png)

虽然都是用`hyLoginRequest`这个实例，但是这个实例下发起的请求，有些是不需要权限，也就是不需要`token`

并不是说，用了`hyLoginRequest`，那么用它发起的这个请求就必然会携带上`token`

---

> [Demo](https://github.com/ppambler/QQMusic/commit/b9c56ac)

3）













