### âœï¸ Tangxt â³ 2022-03-28 ğŸ·ï¸ å°ç¨‹åº

# 06-HYMusic æœç´¢â»šå’Œæœç´¢åŠŸèƒ½å¼€å‘

1ï¼‰ç­”ç–‘

ğŸ’¡ï¼šäº‹ä»¶æ€»çº¿ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ

- è·¨ç»„ä»¶é€šä¿¡
- è·¨é¡µé¢é€šä¿¡

äº‹ä»¶æ€»çº¿ -> ç±»ä¼¼è®¢é˜…å‘å¸ƒæ¨¡å¼ -> ç›¸å½“äºæ˜¯ä¸€ç§äº‹ä»¶ä¼ é€’

A `$emit` ä¸€ä¸ªäº‹ä»¶ï¼Œæ­¤æ—¶ B ç»„ä»¶è¿˜æœªåˆ›å»ºï¼Œé‚£ä¹ˆ B ç»„ä»¶èƒ½ç›‘å¬åˆ°è¿™ä¸ªäº‹ä»¶å—ï¼Ÿ -> ä¸€èˆ¬æ˜¯ä¸èƒ½çš„ï¼Œé™¤éä½ åšäº†ç‰¹æ®Šå¤„ç†çš„ï¼Œæ¯”å¦‚è€å¸ˆå†™çš„é‚£ä¸ªåº“ EventStoreï¼Œç¬¬ä¸€æ¬¡ç›‘å¬äº‹ä»¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘ä¸€æ¬¡å›è°ƒï¼

ğŸ’¡ï¼špnpm æ˜¯è¶‹åŠ¿å—ï¼Ÿ

ç°åœ¨å¾ˆå¤šé¡¹ç›®åœ¨ç”¨å®ƒï¼Œä½†å˜æˆæ•´ä½“è¶‹åŠ¿è¿˜ä¸å¥½è¯´ï¼Œæ¯•ç«Ÿ npm ä¹Ÿåœ¨æ›´æ–°ï¼Œä¹Ÿå˜å¾—è¶Šæ¥è¶Šå¥½ç”¨äº†

æ€»ä¹‹ï¼Œçœ‹åè¾¹å‘å±•æƒ…å†µå°±å¾—äº†ï¼

ğŸ’¡ï¼šéŸ³è§†é¢‘æ–¹å‘ï¼Ÿ

éŸ³è§†é¢‘æœªæ¥ä¼šè¶Šæ¥è¶Šå¥½ -> ç½‘é€Ÿä¼šè¶Šæ¥è¶Šå¿«ï¼ˆä¸ç®¡æœ‰æ²¡æœ‰ 5G éƒ½è¿™æ ·ï¼‰ï¼Œå†åŠ ä¸Šå…ƒå®‡å®™ï¼Œå…ƒå®‡å®™å¦‚æœç«èµ·æ¥ï¼Œé‚£å®ƒå†…éƒ¨å¯¹éŸ³è§†é¢‘è¿™äº›ä¸œè¥¿ä¹Ÿæ˜¯è¦æ±‚å¾ˆé«˜çš„ï¼ -> VRï¼ˆç›®å‰ VR çœ¼é•œåˆ†è¾¨ç‡ä½ï¼Œä½“éªŒä¸å¥½ï¼Œä½†è¿™ç»ˆå½’æ˜¯æœªæ¥çš„ä¸€ç§è¶‹åŠ¿ï¼Œç›®å‰ä½ æƒ³ä½“éªŒå¥½ç‚¹çš„è¯ï¼Œå¾—è®¾å¤‡å¥½+ç½‘é€Ÿå¿«ï¼‰

ğŸ’¡ï¼šå‰ç«¯åˆ°é«˜çº§äº†ï¼Œæ˜¯ä¸æ˜¯å°±ä¸ä»…é™äºé¡µé¢ä¸šåŠ¡äº†ï¼Ÿ

æ˜¯çš„ -> ä¸šåŠ¡ä½ åšå¤šäº†çš„è¯ï¼Œä½ ä¼šå‘ç°ä¸šåŠ¡éƒ½å·®ä¸å¤šçš„

ğŸ’¡ï¼šbug æ’æŸ¥ï¼Ÿ

ç¼©å°èŒƒå›´ -> å®šä½åˆ°ä»€ä¹ˆæ—¶å€™æƒ…å†µä¸‹ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ -> é’ˆå¯¹æ€§è§£å†³è¿™ä¸ªé—®é¢˜

---

2ï¼‰æŒæ¡è·³è½¬æ­Œæ›²è¯¦æƒ…é¡µ-åŒºåˆ†æ¦œå•

ğŸ’¡ï¼šåšä»€ä¹ˆï¼Ÿ

æŸä¸ªæ’è¡Œæ¦œè¯¦æƒ…é¡µï¼š

![åš](assets/img/2022-03-29-14-35-43.png)

æŸä¸ªæ­Œå•çš„è¯¦æƒ…é¡µï¼š

![åš](assets/img/2022-03-29-14-36-31.png)

ğŸ’¡ï¼šæ€ä¹ˆåšï¼Ÿ

è¿™æ˜¯æˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹ï¼š

![æ€ä¹ˆåš](assets/img/2022-03-29-14-40-57.png)

ğŸ’¡ï¼šå®ç°å®ƒï¼Ÿ

å…ˆæ¥å®Œæˆæ¦œå•çš„è¯¦æƒ…é¡µï¼š

1. è°è¦è·³è½¬ï¼Ÿ -> ã€Œæ›´å¤šã€ã€æ¦œå•æ’è¡Œæ¦œçš„æ•´ä¸ªåŒºåŸŸ
2. åœ¨`pages`æ——ä¸‹ï¼Œåˆ›å»º`detail-songs`é¡µé¢

åœ¨å“ªå„¿å¤„ç†äº‹ä»¶ï¼Ÿ

ç»„ä»¶å—ï¼Ÿ -> ä¸æ˜¯ -> æœ‰ä¸¤ä¸ªã€Œæ›´å¤šã€ï¼Œè¿™ä¸¤ä¸ªæ›´å¤šçš„é€»è¾‘æ˜¯ä¸ä¸€æ ·çš„ -> æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åœ¨ç»„ä»¶å†…éƒ¨å¤„ç†äº‹ä»¶ï¼Œè€Œæ˜¯è®©ç»„ä»¶æŠŠè¿™ä¸ªäº‹ä»¶å‘é€å‡ºå»

![æ›´å¤š](assets/img/2022-03-29-17-16-04.png)

![äº‹ä»¶å¤„ç†](assets/img/2022-03-29-18-08-50.png)

![å‘é€äº‹ä»¶](assets/img/2022-03-29-17-18-36.png)

![äº‹ä»¶å‘é€](assets/img/2022-03-29-17-20-25.png)

![äº‹ä»¶ç›‘å¬](assets/img/2022-03-29-18-07-27.png)

> ä»¥ä¸Šæ˜¯é’ˆå¯¹ã€Œçƒ­é—¨æ¦œã€çš„ç›‘å¬å¤„ç† -> ä¹Ÿå°±æ˜¯ã€Œæ¨èæ­Œæ›²ã€çš„`æ›´å¤š`

ğŸ’¡ï¼šæ¦œå•çš„äº‹ä»¶ç›‘å¬

![ç›‘å¬æ¦œå•](assets/img/2022-03-29-17-24-32.png)

æœ‰ä¸¤ç§æ–¹æ³•ç›‘å¬ï¼š

1. ç›´æ¥åœ¨è‡ªå®šä¹‰ç»„ä»¶å†™`bindtap`ï¼Œä¸ç”¨åœ¨ç»„ä»¶å†…éƒ¨å†™`this.triggerEvent('click')` -> å†…ç½®ç»„ä»¶ï¼ˆå¦‚`view`ï¼‰å¯ä»¥ç”¨`bindtap`ï¼Œè‡ªå®šä¹‰ç»„ä»¶ä¹Ÿå¯ä»¥ç›´æ¥ç”¨
2. ä½ ä¹Ÿå¯ä»¥åœ¨è‡ªå®šä¹‰ç»„ä»¶çš„`wxml`é‡Œè¾¹çš„`view`æ ¹æ ‡ç­¾ç›‘å¬è¿™ä¸ª`bindtap`äº‹ä»¶ï¼Œæ¯•ç«Ÿè¿™æ˜¯é’ˆå¯¹æ•´ä¸ª Item çš„ç›‘å¬ï¼Œä¸æ˜¯å…·ä½“åˆ°æŸä¸ªå›¾ç‰‡çš„ç›‘å¬ï¼Œç„¶ååœ¨æŠŠäº‹ä»¶`triggerEvent`å‡ºå»

åœ¨è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç¬¬ä¸€ç§ï¼Œå› ä¸ºè¿™ä¸ª`æ›´å¤š`çš„äº‹ä»¶å¤„ç†å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œä¸ºäº†æ–¹ä¾¿æ—¥åç»´æŠ¤å’Œä¿®æ”¹ï¼Œæˆ‘ä»¬é€‰æ‹©ç¬¬ä¸€ç§

![å¤„ç†å‡½æ•°](assets/img/2022-03-29-17-33-56.png)

ç”±äºéœ€è¦ä¼ é€’å‚æ•°ï¼Œæˆ‘ä»¬å¯¹åŸå…ˆçš„å¤„ç†å‡½æ•°é‡Œè¾¹çš„é€»è¾‘ï¼Œæå–æˆä¸€ä¸ªå‡½æ•°æ¥è°ƒç”¨ï¼š

![å¤„ç†](assets/img/2022-03-29-18-51-58.png)

è·å–å‚æ•°ï¼š

![å¤„ç†](assets/img/2022-03-29-17-44-14.png)

åœ¨å‚æ•°çš„å¤„ç†æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¹‹å‰åœ¨`ranking-store`é‡Œçš„`rankingMap`ï¼š

![rankingMap](assets/img/2022-03-29-17-47-59.png)

> è¿™ç§ç®€å†™æ–¹å¼å¯è¯»æ€§ä¸å¼º -> ä½†å¦‚æœä½ ç†è§£æ¸…æ¥šäº†ï¼Œå¯ä»¥å°‘å†™å¾ˆå¤šä»£ç 

![rankingMap](assets/img/2022-03-29-17-51-46.png)

è·å–è¿™äº›æ•°æ®çš„æ„ä¹‰ï¼š

![è·å–æ•°æ®](assets/img/2022-03-29-17-54-09.png)

> [Demo](https://github.com/ppambler/QQMusic/commit/2375309)

3ï¼‰ç­”ç–‘

ğŸ’¡ï¼šè‡ªå®šä¹‰å±æ€§`data`å¯ä»¥ä¼ å¯¹è±¡å—ï¼Ÿ

å¯ä»¥çš„

å›½å¤–è§†é¢‘èµ·å -> `index`ã€`indez`ã€`indey` -> æ‰€ä»¥è€å¸ˆä¹ æƒ¯å«`idx`ï¼Œè€Œä¸æ˜¯`id`

4ï¼‰æŒæ¡æ­Œæ›²è¯¦æƒ…é¡µ-æ¦œå•æ•°æ®å±•ç¤º

ğŸ’¡ï¼šè¯¦æƒ…é¡µçŸ¥é“æ‹¿ä»€ä¹ˆæ•°æ®åï¼Œé‚£å°±å¾—è·å–è¿™ä¸ªæ•°æ®äº†ï¼Œè·å–å®Œæ•°æ®åï¼Œå°±å¾—å±•ç¤ºæ•°æ®

è·å–æ•°æ®ï¼š

![æ•°æ®è·å–](assets/img/2022-03-29-18-27-24.png)

å±•ç¤ºæ•°æ®ï¼š

1. æŠŠæ•°æ®å­˜æ”¾åˆ°`songInfo`é‡Œè¾¹
2. å®šä¹‰`wxml`ç»“æ„å±•ç¤ºæ•°æ®

ğŸ’¡ï¼šåˆ›å»ºä¸€ä¸ª`song-item-v2`

![song-item-v2](assets/img/2022-03-29-18-33-52.png)

ä¸çŸ¥å±æ€§åä»£è¡¨å“ªäº›æ•°æ®ï¼Ÿ

![æ•°æ®](assets/img/2022-03-29-18-39-28.png)

å…³äºæ ·å¼çš„æ‹·è´ï¼Ÿ

ç”±äºç»å¸¸å°è£…ç»„ä»¶ï¼Œä½ çš„æ ·å¼èµ·åä¸€å®šè¦ç¬¦åˆä½ çš„ä¹ æƒ¯ -> `song-item-v1`å’Œ`song-item-v2`çš„æ ·å¼æœ‰å…±é€šä¹‹å¤„ -> æ ·å¼èµ·åï¼Œä¹Ÿå°±æ˜¯ç»™ç»„ä»¶æ ‡ç­¾æ·»åŠ `class`è¦ä¸€è‡´

ä¼˜åŒ–ï¼šæœ‰äº›æ­Œæ›²æ²¡æœ‰åˆ«å

![åˆ«å](assets/img/2022-03-29-18-47-17.png)

> 01 34 59

> [Demo](https://github.com/ppambler/QQMusic/commit/34ebf96)

ğŸ‘‡ï¼šç‚¹å‡»æ­Œå•çš„åŒºåˆ†

5ï¼‰

