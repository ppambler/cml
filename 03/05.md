### âœï¸ Tangxt â³ 2022-03-26 ðŸ·ï¸ å°ç¨‹åº

# 05-HYMusic è§†é¢‘â¾¸â»šå’Œè¯¦æƒ…â»šå¼€å‘

1ï¼‰æŽŒæ¡éŸ³ä¹é¡µé¢-æ­Œå•åŒºåŸŸçš„å¸ƒå±€ç»†èŠ‚

> å…³äºŽç›´æ’­è¯¾ï¼Œæœ‰äººæ¯æ¬¡ç›´æ’­éƒ½æ¥å¬ï¼Œæœ‰äººæ¥å‡ æ¬¡åŽå°±ä¸å¬äº† -> äººä¸Žäººä¹‹é—´çš„å·®è·å°±è¿™æ ·æ‹‰å¼€äº†å—ï¼Ÿ -> å¹¶ä¸æ˜¯ï¼Œå·®è·ä¸æ˜¯ä¸€å¤©ä¸¤å¤©å°±èƒ½æ‹‰å¼€äº†ï¼Œè€Œæ˜¯ä¸€ä¸ªäººçš„ä¹ æƒ¯ -> ç‰›é€¼çš„äººï¼Œéƒ½æœ‰å¾ˆå¥½åœ°å­¦ä¹ ä¹ æƒ¯

ðŸ’¡ï¼šæŽ¨èæ­Œæ›²çš„ Item å›¾ç‰‡æœ‰ç‚¹å¤§ï¼Ÿ

å¯ä»¥æžä¸ª wxs æ¥ä¼˜åŒ–ä¸€ä¸‹

ðŸ’¡ï¼šå›¾ç‰‡è½¬ Base64ï¼Ÿ

- JS è½¬
- åŽç«¯è½¬
- çº¿ä¸Šå·¥å…·è½¬

ðŸ’¡ï¼šå…ˆæ·±åº¦åŽå¹¿åº¦ï¼Ÿ

ç»¼åˆèµ·æ¥å­¦

ðŸ’¡ï¼šåšä»€ä¹ˆï¼Ÿ

![do](assets/img/2022-03-26-17-44-10.png)

ç›®å‰è¦å°è£…çš„è¿™ä¸ªç»„ä»¶ï¼Œå…¶å®žåªæ˜¯åœ¨è¿™ä¸ªéŸ³ä¹é¦–é¡µé‡Œè¾¹ä½¿ç”¨ï¼Œæ‰€ä»¥æœ€åˆåœ¨å®žçŽ°å®ƒçš„æ—¶å€™ï¼Œæ˜¯æ”¾åˆ°é¡µé¢é‡Œçš„`cpns`ç›®å½•é‡Œè¾¹çš„ï¼Œä¸è¿‡ä¸ºäº†æ–¹ä¾¿æ—¥åŽä¼šæœ‰å…¶ä»–é¡µé¢éœ€è¦ç”¨åˆ°è¿™ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬çŽ°åœ¨æ¥å®žçŽ°å®ƒçš„è¯ï¼Œæ˜¯æŠŠå®ƒæ”¾åˆ°`components`ç›®å½•é‡Œè¾¹

ðŸ’¡ï¼šå°è£…`song-menu-area`ç»„ä»¶

`menu`è¿™ä¸ªåå­—æƒ³äº†å¾ˆä¹…ï¼Œæœ€ç»ˆè¿˜æ˜¯ç”¨äº†è¿™ä¸ª`menu`

é¢˜å¤–è¯ï¼š

![é¢˜å¤–è¯](assets/img/2022-03-26-17-49-29.png)

---

å°è£…ç»„ä»¶æ—¶ï¼Œå…³äºŽ`wxml`ä¼¼ä¹Žéœ€è¦ä¸€ä¸ª`view`åŒ…è£¹ï¼Ÿ -> çœ‹ä½ æ˜¯æ€Žä¹ˆæƒ³çš„ï¼Œç”¨ä¸€ä¸ª`view`åŒ…è£¹çš„è¯ï¼ŒæžèƒŒæ™¯è‰²å’Œæ·»åŠ è¾¹è·æ˜¯éžå¸¸æ–¹ä¾¿çš„ -> å¦‚æžœä½ ç”¨ä¸ä¸Šè¿™ä¸ª`view`ï¼Œé‚£ä¹ˆä½ ä¹Ÿå¯ä»¥ä¸æ·»åŠ 

---

ä½ è‡ªå®šä¹‰ä¸€ä¸ªç»„ä»¶ -> åœ¨å†™`wxml`æ—¶éœ€è¦åˆ°å…¶å®ƒç»„ä»¶ -> é‚£ä¹ˆè¿™åŒæ ·éœ€è¦æ³¨å†Œè¿™ä¸ªç»„ä»¶

---

`scroll-view` -> å…³äºŽ x è½´å’Œ y è½´çš„åˆ’åˆ†ï¼š

![x è½´](assets/img/2022-03-26-17-59-04.png)

---

> ä¸ºäº†æ–¹ä¾¿å¼€å‘ -> æš‚æ—¶æŠŠé‚£ä¸ªæŽ¨èæ­Œæ›²æ¦œå•ç»™æ³¨é‡Šäº†

å·¦å³æ»‘æœ‰å‡ ä¸ª Item -> æŒ‰ç…§å…¶å®ƒåº”ç”¨çš„è®¾è®¡ -> æ€»å…±æœ‰ `6` ä¸ªæ­Œå•ä¿¡æ¯

å…ˆä¸è¯·æ±‚çœŸå®žæ•°æ®ï¼Œæˆ‘ä»¬éåŽ†æ•°å­—`6`æ¥å¾—åˆ°`6`ä¸ª Item -> å†™ä¸Šç›¸åº”çš„æ ·å¼

![æ•ˆæžœ](assets/img/2022-03-26-18-18-17.png)

ç»†èŠ‚å¤„ç†ï¼š

- å…¼å®¹æŸäº›è®¾å¤‡ -> æŸäº›è®¾å¤‡æ˜¯è¿™æ ·çš„ï¼šæœ‰äº› Item ä¼šå‘ä¸Šèµ°ä¸€ç‚¹ï¼Œæœ‰äº›åˆ™ä¼šå‘ä¸‹èµ°ä¸€ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬æ²¡æœ‰å¯¹é½ -> `vertical-align: top`
- å·¦å³æ»‘åŠ¨çš„æ¶ˆå¤±å’Œå‡ºçŽ° -> å¾€å·¦æ»‘æ—¶ï¼Œä¹Ÿå°±æ˜¯ Item æ¶ˆå¤±æ˜¯ä»Žå±å¹•å·¦ä¾§è¾¹ç¼˜æ¶ˆå¤±çš„ï¼Œå¯ä¸æ˜¯`padding-left`è¿™ä¸ªä½ç½®æ¶ˆå¤±ï¼ŒåŒç†ï¼ŒItem å‡ºçŽ°çš„æ—¶å€™ï¼Œæ˜¯ä»Žå±å¹•å³ä¾§å‡ºçŽ°çš„ï¼Œå¯ä¸æ˜¯ä»Ž`padding-right`è¿™ä¸ªä½ç½®å‡ºçŽ°çš„
- ç¬¬ä¸€ä¸ª Item è¦å’Œçƒ­é—¨æ­Œå•è¿™ä¸ªæ ‡é¢˜çš„å·¦è¾¹å¯¹é½ -> æ”¹æˆ`margin-right`å—ï¼Ÿ -> ä¸è¡Œï¼Œè¿™æ ·çš„è¯ï¼Œæœ€åŽä¸€ä¸ª`Item`ä¹Ÿä¼šå¯¹ä¸é½

æˆ‘ä»¬å…ˆæ¥å¤„ç† Item çš„æ¶ˆå¤±æˆ–å‡ºçŽ°çš„è¾¹ç¼˜é—®é¢˜ï¼Œç„¶åŽå†æ¥å¤„ç†ç¬¬ä¸€ä¸ª Item çš„å¯¹é½é—®é¢˜

---

æˆ‘ä»¬ä¸æƒ³è®©`scroll-view`è¿™ä¸ªå…ƒç´ æœ‰å†…è¾¹è·ï¼Œå¯æˆ‘ä»¬å¯¹è¿™ä¸ª`page`éƒ½è®¾ç½®å†…è¾¹è·äº†ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„å¸ƒå±€æ˜¯åœ¨è¿™ä¸ªç»¿è‰²æ¡†æ¡†é‡Œè¾¹è¿›è¡Œçš„ï¼š

![å¸ƒå±€](assets/img/2022-03-26-18-32-06.png)

å…¶å®ƒå…ƒç´ éƒ½è¦å†…è¾¹è·ï¼Œå°±`scroll-view`ä¸æƒ³è¦ -> æˆ‘ä»¬éš¾é“è¦æŠŠ`page`è®¾ç½®çš„å†…è¾¹è·ç»™åŽ»æŽ‰ï¼Œç„¶åŽå†å¯¹è¿™äº›éœ€è¦å†…è¾¹è·çš„å…ƒç´ ä¸€ä¸ªä¸ªåŽ»è®¾ç½®å—ï¼Ÿ

æˆ‘ä»¬è¿™é‡Œçš„æ–¹æ¡ˆæ˜¯ä¿æŒåŽŸæœ‰`page`è®¾ç½®çš„å†…è¾¹è·ï¼Œå•ç‹¬ç»™`scroll-view`è®¾ç½®ä¸è¦å†…è¾¹è·ï¼Œå³è®©å®ƒå æ»¡æ•´ä¸ªå±å¹•çš„å®½åº¦

ä¸¤ç§æ€è·¯ï¼š

1. ç›´æŽ¥èŽ·å–å±å¹•çš„å®½åº¦
   1. å±å¹•å®½åº¦æ•°æ®èŽ·å– -> `wx.getSystemInfoSync()` -> è¿™ä¸ªæ•°æ®æ˜¯ä¸ä¼šå˜çš„ï¼Œæ¯•ç«ŸåŒä¸€å°æ‰‹æœºçš„å±å¹•å®½åº¦æ€»ä¸èƒ½ä¸€å¤©ä¸€ä¸ªæ ·å§ -> æ‰€ä»¥æŠŠè¿™ä¸ªæ•°æ®å­˜å‚¨åˆ°`store`é‡Œè¾¹æ˜¯ä¸åˆç†çš„ï¼Œæ¯•ç«Ÿ`store`çš„ç‰¹ç‚¹æ˜¯å“åº”å¼ -> æ”¾åˆ°`app.js`é‡Œè¾¹çš„`globalData` -> åœ¨`onLaunch`è¿™ä¸ªé’©å­é‡Œè°ƒç”¨è¿™ä¸ª APIï¼Œæ³¨æ„è¿™æ˜¯åŒæ­¥æ–¹æ³•ï¼Œæˆ‘ä»¬æƒ³ç­‰è¿™ä¸ªç»“æžœ
   2. å±å¹•å®½åº¦æ•°æ®æœ‰äº†ï¼Œå°±æŠŠå†…è”æ ·å¼çš„æ–¹å¼æŠŠå®ƒæžåˆ°ç»„ä»¶çš„`style`å±žæ€§é‡Œè¾¹åŽ»

![æ€è·¯ä¸€](assets/img/2022-03-26-18-54-34.png)

`scroll-view`å¤„ç†å‰`355px` -> å¤„ç†åŽ`375px`

è¿™ä¸ªæ–¹æ¡ˆæœ‰ç‚¹å¤æ‚ï¼Œè¿˜æœ‰ä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ¡ˆ

é‚£å°±æ˜¯ç›´æŽ¥ç»™`.menu-list`ï¼Œä¹Ÿå°±æ˜¯`scroll-view`ä¸€ä¸ª`100vw`çš„å®½ï¼Œè¿™æ ·å°±ä¸ç”¨é€šè¿‡ JS åŽ»èŽ·å–è®¾å¤‡çš„`width`å€¼äº†

ðŸ‘‡ï¼šæŠŠçº¢è‰²æ¡†æ¡†æ”¹æˆæ˜¯æˆ‘ä»¬æƒ³è¦çš„å¸ƒå±€ã€çœŸå®žæ•°æ®å±•ç¤º

2ï¼‰æŽŒæ¡éŸ³ä¹é¡µé¢-çƒ­é—¨å’ŒæŽ¨èæ­Œå•çš„å±•ç¤º

ðŸ’¡ï¼šå±•ç¤ºæ¯ä¸ªå°æ­Œå•

èŽ·å–æ­Œå•çš„æŽ¥å£ï¼š

![æ­Œå•](assets/img/2022-03-26-19-36-35.png)

å®šä¹‰è¯·æ±‚æ–¹æ³•ï¼š

``` js
// cat -> category ç±»åˆ«
export function getSongMenu(cat="å…¨éƒ¨", limit=6, offset=0) {
  return hyRequest.get("/top/playlist", {
    cat,
    limit,
    offset
  })
}
```

åœ¨å“ªå„¿å‘é€è¯·æ±‚å‘¢ï¼Ÿ

ä½ å¯ä»¥åœ¨è¿™ä¸ª`song-menu-area`ç»„ä»¶é‡Œè¾¹å‘é€ï¼Œä¸è¿‡ä½ è¿™æ ·åšçš„è¯ï¼Œé‚£è¿™ä¸ªç»„ä»¶çš„å¤ç”¨æ€§å°±å·®ä¸€ç‚¹äº†

æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬æ˜¯**åœ¨é¡µé¢é‡Œè¾¹å‘é€**ï¼ŒæŠŠè¯·æ±‚å›žæ¥çš„æ•°æ®ï¼Œå†ä¼ ç»™ç»„ä»¶åŽ»å±•ç¤º -> è¿™æ ·ä¸€æ¥ï¼Œè¿™ä¸ªç»„ä»¶çš„å¤ç”¨æ€§å°±å¼ºå¾ˆå¤šäº† -> æ¯”å¦‚ã€ŒæŽ¨èæ­Œå•ã€å°±å¯ä»¥ç”¨è¿™ä¸ªç»„ä»¶äº†ï¼Œåªæ˜¯æ•°æ®ä¸åŒç½¢äº†

ðŸ’¡ï¼šå°è£…`song-menu-item`ç»„ä»¶

å¦‚æžœå…¶ä»–åœ°æ–¹æœ‰è¿™ä¸ªç»„ä»¶çš„è¯ï¼Œé‚£ä¹ˆä½ å¯ä»¥åŠ ä¸ª`v1`è¿™æ ·çš„å‰ç¼€

è¿™ä¸ªç»„ä»¶çš„`wxml`ç”¨äº†ä¸€ä¸ª`view`åŒ…è£¹ -> å› ä¸ºè¿™æ˜¯ä¸€ä½“çš„

ðŸ’¡ï¼šæŽ¨èæ­Œå•

åŒçƒ­é—¨æ­Œå•ï¼Œåªæ˜¯æ•°æ®ä¸åŒç½¢äº† -> è¿™å°±æ˜¯å°è£…ç»„ä»¶çš„æ„ä¹‰

æŽ¨èçš„æ˜¯ã€ŒåŽè¯­æ­Œå•ã€ -> å› ä¸ºå¤§å®¶å¤§å¤šéƒ½æ˜¯å¬åŽè¯­æ­Œæ›²çš„

![æŽ¨èæ­Œå•](assets/img/2022-03-26-21-10-50.png)

> [Demo](https://github.com/ppambler/QQMusic/commit/ea67d0c)

3ï¼‰
